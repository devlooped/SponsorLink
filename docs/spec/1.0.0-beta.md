---
layout: default
title: 1.0.0-beta
parent: Manifest Spec
---
<!-- #content -->
# SponsorLink Manifest 1.0

## Summary

A SponsorLink manifest is a JWT token that contains a list of hashes 
representing a user or organization sponsorships. It can be used to unlock 
sponsors-only features or to remove messages asking for sponsorships. 

## Introduction

A standard mechanism for representing sponsorships and checking for them in 
a privacy-preserving, offline and safe manner would be beneficial to both 
OSS authors and users.

## Format

A SponsorLink manifest is a (optionally signed) JWT token containing the 
following claims:

| Claim | Description |
| ----- | ----------- |
| `aud` | The audience of the token, which must be `SponsorLink` |
| `hash` | A list of hashes representing sponsorships |
| `exp` | The expiration date of the token |
| `iss` | The issuer of the token |
| `sub` | The user identifier (e.g. GitHub user id) |

Example:

```json
{
  "aud": "SponsorLink",
  "hash": [
    "BDijrDmFcAe21P8otS3q0qtY2n/XPd3UL3loZlaGlF0=",
    "dk3xig+I5FgtQwfPaS3BGhtgru9DkKd5Bm8lKwVBboY="
  ],
  "exp": 1696118400,
  "iss": "[SOME_ISSUER]",
  "sub": "[USER_ID]"
}
```

### Hashing

On first usage of any SponsorLink tool used to generate or synchronize a 
manifest, a random string (typically a GUID) is generated and stored in 
a user environment variable named `SPONSORLINK_INSTALLATION`. This string 
is used as a salt in all hashes generated for that installation. 

A manifest generation tool will: 

1. Identify the user (e.g. GitHub user id, Open Collective account, etc.) 
   and the account(s) it's sponsoring.
2. Generate a hash for each account using the salt, the user identifier and 
   sponsored account with: `base64(sha256([SALT]+[USER]+[SPONSORED]))`.


### Signing

A particular implementation might choose to sign the JWT token with a 
private key via a backend service. This is not required, but it's 
recommended to prevent tampering with the manifest. 

The manifest can be generated entirely via a backend service with access 
to sponsorships information, or it can be generated locally and then sent 
for signing only to a backend service.

A signing (or generation + signing) backend would typically use a private
key to sign the JWT token with RS256. The public key would be distributed
to their manifest consuming libraries and tools can verify the signature.

### Subject

The `sub` claim can be used by the backend service to identify the user 
the manifest applies to. A given issuer (of signing or both manifest + 
signing) is free to choose the format of the `sub` claim as well as its 
validation or authentication mechanism. 

For unsigned manifests, the `sub` claim is typically unused.

## Usage

The manifest is stored in a user environment variable named `SPONSORLINK_MANIFEST`.
This variable along with `SPONSORLINK_INSTALLATION` can be used by a tool 
or library author to check for sponsorships entirely locally, offline and 
safely.

If both variables are found, the manifest can be read with any standard JWT 
library and optionally checked against a public key shared by the *issuer*.

The author can optionally check for expiration too, decide on a grace period 
and issue a message if the manifest is expired.

Finally, the author can identify the user (using the same mechanism used 
for manifest generation), create the hash for their sponsorable account 
(i.e. GitHub user/org, Open Collective account, etc.) and check if it's 
present in the manifest.

## Privacy Considerations

* User identification for manifest generation is entirely up to the issuer. 
* User identification for manifest consumption is entirely up to the tool or 
  library author.

Once a manifest is generated (and optionally signed) and stored in the 
`SPONSORLINK_MANIFEST` environment variable, it can be used by any tool or 
library to check for sponsorships locally without any further access to the 
user's information, solely using his identifier. One common identifier is the 
user's email address, which is readily available in the `git` configuration, for 
example. The email's domain name can be used to check for organization-wide 
sponsorships too, for example.